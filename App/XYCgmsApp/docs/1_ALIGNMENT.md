# XYCgmsApp 需求对齐文档

## 原始需求

XYCgmsApp是一个实时血糖监测的App（CGMS）。核心功能是通过蓝牙读取植入在身体的CGMS血糖监测仪器的血糖监测数据，展示给用户，并给出血糖预警提示。关于数据的展示，使用合适的方式进行数据展示，如血糖曲线。同时包括血糖数据的存储，包括通过蓝牙将数据从CGMS设备中存储到手机本地和通过网络将数据存储到云端服务器。App需要支持多个平台（iOS、iPad、macOS、watchOS）。

## 边界确认

### 任务范围

1. **核心功能**
   - 蓝牙连接CGMS设备并读取实时血糖数据
   - 血糖数据本地存储
   - 血糖数据云端存储
   - 血糖数据可视化展示（曲线图表）
   - 血糖异常预警提示

2. **支持平台**
   - iOS（iPhone）
   - iPadOS
   - macOS
   - watchOS

### 非任务范围

1. **硬件相关**
   - CGMS硬件设备的设计与开发
   - 蓝牙协议的自定义开发（仅使用标准协议）

2. **云端系统**
   - 云端服务器的搭建与维护
   - 服务器端API的具体实现
   - 大规模数据处理架构

3. **其他**
   - 医疗认证相关流程
   - 第三方健康平台集成（初期）
   - 用户账户系统的完整实现（可与云端API集成）

## 需求理解

### 项目概述

XYCgmsApp是一个跨平台的实时血糖监测应用，旨在为糖尿病患者提供便捷、直观的血糖管理解决方案。通过与CGMS设备的蓝牙连接，实现血糖数据的实时获取、存储、分析和预警，帮助用户更好地管理自己的健康状况。

### 关键功能点

1. **蓝牙通信模块**
   - 设备扫描与配对
   - 实时数据传输
   - 连接状态管理
   - 设备信息获取

2. **数据存储模块**
   - 本地数据库设计与实现
   - 云端数据同步机制
   - 数据加密与安全存储
   - 历史数据查询与导出

3. **数据可视化模块**
   - 血糖趋势曲线图
   - 统计数据展示
   - 异常值标记
   - 多时间维度查看（日/周/月/年）

4. **预警系统**
   - 血糖阈值设置
   - 高低血糖预警通知
   - 预警历史记录
   - 预警方式配置（声音、震动、通知等）

5. **多平台适配**
   - UI适配不同屏幕尺寸
   - 功能差异化实现（考虑各平台特性）
   - 数据同步机制
   - 平台特定API的封装与抽象

### 技术栈选择

基于跨平台需求和项目特性，推荐使用Swift/SwiftUI作为主要开发技术栈，利用其原生支持多平台开发的优势。

## 疑问澄清

### 高优先级疑问

1. **CGMS设备规格**
   Q: CGMS设备使用的蓝牙协议具体是哪一种？
   A: CGMS设备使用的蓝牙协议是BLE（Bluetooth Low Energy）协议。

   Q: 设备的血糖数据传输格式是什么？
   A: 设备通过BLE协议将实时血糖数据以二进制格式传输。

2. **数据安全要求**
   Q: 本地和云端数据是否需要加密存储？
   A: 本地和云端数据都需要加密存储，以确保用户隐私和数据安全。

   Q: 是否有特定的数据隐私保护法规需要遵守？（如HIPAA）
   A: 为了遵守数据隐私保护法规，所有用户数据都必须加密存储，并且只能被授权的个人或系统访问。

3. **预警机制细节**
   Q: 预警阈值是否可由用户自定义？
   A: 是，用户可以在应用中自定义预警阈值。

   Q: 预警通知的优先级和方式有哪些？
   A: 预警通知可以通过声音、震动、通知等方式进行。

   Q: 是否需要支持多用户预警（如家人通知）？
   A: 是，应用需要支持多用户预警，用户可以配置哪些用户接收预警通知。

4. **云端集成方案**
   Q: 是否已有云端API？如果有，需要明确API规格
   A: 是，应用需要与已有的云端API进行集成，API规格包括数据格式、接口地址、请求方法、参数说明等。

   Q: 数据同步频率如何定义？
   A: 数据同步频率可以根据用户需求进行配置，例如每小时同步一次、每天同步一次等。

   Q: 离线模式如何处理？
   A: 当应用在离线状态下运行时，需要缓存用户操作和数据，待重新连接到互联网后进行同步。 同步时需要确保数据的完整性和准确性。

### 中优先级疑问

1. **数据可视化要求**
   Q: 需要展示哪些具体的数据指标？
   A: 应用需要展示用户的实时血糖数据曲线、统计数据（如平均血糖值、最高/最低血糖值等）、异常值标记等。

   Q: 是否需要支持数据导出功能？支持哪些格式？
   A: 是，应用需要支持用户导出历史数据（如CSV格式），以便用户进行分析或与其他健康管理工具集成。

2. **用户界面要求**
   Q: 是否有特定的UI设计规范或风格指南？
   A: 是，应用需要遵循苹果的UI设计规范，确保一致性和用户友好性。

   Q: 各平台是否有差异化的UI需求？
   A: 是，不同平台（如iOS、iPadOS、macOS、watchOS）可能有不同的UI需求，应用需要根据平台特点进行适配。

3. **性能要求**
   Q: 蓝牙连接和数据传输的响应时间要求？
   A: 蓝牙连接和数据传输的响应时间要求在指定时间内完成，以确保用户体验。

   Q: 应用在后台运行时的资源使用限制？
   A: 应用在后台运行时需要限制资源使用，以防止对用户电池寿命的影响。

### 低优先级疑问

1. **辅助功能需求**
   Q: 是否需要支持无障碍功能？
   A: 是，应用需要支持无障碍功能，确保所有用户都能正常使用。

   Q: 是否需要支持多语言？
   A: 是，应用需要支持多语言，以满足不同用户的需求。

2. **其他扩展功能**
   Q: 是否需要支持与其他健康设备的数据集成？
   A: 是，应用需要支持与其他健康设备（如胰岛素泵、血糖仪等）的数据集成，以提供更全面的健康管理功能。

   Q: 是否需要支持胰岛素剂量记录等相关功能？
   A: 是，应用需要支持用户记录和管理胰岛素剂量，以便与血糖数据进行关联分析。

---

本文档将根据后续澄清和讨论持续更新，确保需求理解的准确性和完整性。